

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>06-Derivatives and Transients &#8212; Computational Tools for Chemical Engineers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'lectures/06-Derivatives';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="07-More Derivatives" href="07-DerivativesAgain.html" />
    <link rel="prev" title="05-More Equation Solving" href="05-EquationsAgain.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Intro and Approach
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../topics.html">Modules</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01-Motive.html">01-Motivation with Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="02-Functions.html">02-Functions of Ideal Gases</a></li>
<li class="toctree-l2"><a class="reference internal" href="03-FunctionsAgain.html">03-Functions of Heat Transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="04-Equations.html">04-Equations to Solve Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="05-EquationsAgain.html">05-More Equation Solving</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">06-Derivatives and Transients</a></li>
<li class="toctree-l2"><a class="reference internal" href="07-DerivativesAgain.html">07-More Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="08-Regression.html">08-Regression and Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="09-RegressionAgain.html">09-More Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="17-SolidWorks.html">Solidworks</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../homework.html">Practice Problems</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../homework/HW01.html">HW01: Introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/HW02.html">HW02: Conditionals and Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/HW03.html">HW03: Solve Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/HW07.html">HW07: Additional Practice</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../casestudies.html">Case Studies</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../casestudies/casestudysch.html">Case Study Schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../casestudies/casestudydocs.html">Case Study Documentation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../foundations.html">Foundations</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../foundations/preClassPrep.html">Pre-course Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../foundations/pythonresources.html">Python Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../foundations/excelresources.html">Excel Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../foundations/equipment.html">Equipment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../foundations/safety.html">Safety</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/clint-bg/comptools/blob/gh-pages/docs/lectures/06-Derivatives.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/clint-bg/comptools" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/clint-bg/comptools/issues/new?title=Issue%20on%20page%20%2Flectures/06-Derivatives.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/lectures/06-Derivatives.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>06-Derivatives and Transients</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#first-example-frictionless-emptying-a-tank-of-fliud">First Example: Frictionless emptying a tank of fliud</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analytical-solution">Analytical Solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-solution-euler-s-method">Numerical Solution: Euler’s Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-solution-ode-int-scipy">Numerical Solution: ODE Int (SciPy)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#second-example-draining-of-tank-with-friction">Second Example: Draining of Tank with Friction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#video-of-the-above-scenario">Video of the above scenario</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="derivatives-and-transients">
<h1>06-Derivatives and Transients<a class="headerlink" href="#derivatives-and-transients" title="Permalink to this heading">#</a></h1>
<p>Many times in engineering, the system is not at steady state. Or in other words, the system variables are changing. We’ll look at some basic methods to readily solve problems where the system is changing with time.</p>
<p>You should understand at the end of this discussion that if you have an expression for the derivative, you can integrate that numerically to determine the system parameters as a function of time.</p>
<section id="first-example-frictionless-emptying-a-tank-of-fliud">
<h2>First Example: Frictionless emptying a tank of fliud<a class="headerlink" href="#first-example-frictionless-emptying-a-tank-of-fliud" title="Permalink to this heading">#</a></h2>
<p>A tank of water is draining through a 1/8 inch diameter hole in the bottom of the tank. The water level in the tank is 7 and 3/16 inches above the hole. The tank is 1 and 9/16 inch in diameter. The density of water is 1000 kg/m<sup>3</sup>. The tank is open to the atmosphere. The flow rate out of the tank is estimated by the following equation:</p>
<p>$$\dot{m} = \rho A \sqrt{2 g h}$$</p>
<p>where $\dot{m}$ is the mass flow rate, $\rho$ is the density, $A$ is the area of the hole, $g$ is the gravitational constant, and $h$ is the height of the water above the hole. This is for a frictionless hole.</p>
<section id="analytical-solution">
<h3>Analytical Solution<a class="headerlink" href="#analytical-solution" title="Permalink to this heading">#</a></h3>
<p>Start with a mass balance</p>
<div class="amsmath math notranslate nohighlight" id="equation-f6854e5f-ec01-4a3d-a38e-ae6bfd42e7a1">
<span class="eqno">(11)<a class="headerlink" href="#equation-f6854e5f-ec01-4a3d-a38e-ae6bfd42e7a1" title="Permalink to this equation">#</a></span>\[\begin{align}
\frac{dm}{dt} &amp;= \dot{m}_{in} - \dot{m}_{out} \\
\frac{dm}{dt} &amp;= 0 - \dot{m}_{out} \\
\frac{dm}{dt} &amp;= -\rho A \sqrt{2 g h} \\
m &amp;= \rho V \\
V &amp;= \frac{\pi}{4} D^2 h \\
\frac{dm}{dt} &amp;= \rho \frac{\pi}{4} D^2 \frac{dh}{dt} = -\rho A \sqrt{2 g h} \\
\frac{dh}{dt} &amp;= -\frac{4}{\pi D^2} A \sqrt{2 g h} \\

\end{align}\]</div>
</section>
<section id="id1">
<h3><a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="amsmath math notranslate nohighlight" id="equation-d04c72da-de63-4fb3-b17c-c5718a0f8ce9">
<span class="eqno">(12)<a class="headerlink" href="#equation-d04c72da-de63-4fb3-b17c-c5718a0f8ce9" title="Permalink to this equation">#</a></span>\[\begin{align}
\frac{dh}{dt} &amp;= -\frac{4}{\pi D^2} A \sqrt{2 g h} \\
\frac{dh}{\sqrt{h}} &amp;= -\frac{4}{\pi D^2} A \sqrt{2 g} dt \\
\int \frac{dh}{\sqrt{h}} &amp;= -\frac{4}{\pi D^2} A \sqrt{2 g} \int dt \\
2 \sqrt{h} &amp;= -\frac{4}{\pi D^2} A \sqrt{2 g} t + C \\
h &amp;= \left(-\frac{2}{\pi D^2} A \sqrt{2 g} t + C\right)^2 
\end{align}\]</div>
<p>With the initial condition that $h(0) = h0$ m, we can solve for $C$:</p>
<div class="amsmath math notranslate nohighlight" id="equation-0406e5f9-6193-45da-a1d3-ee939d6feeb9">
<span class="eqno">(13)<a class="headerlink" href="#equation-0406e5f9-6193-45da-a1d3-ee939d6feeb9" title="Permalink to this equation">#</a></span>\[\begin{align}
h(0) &amp;= \left(-\frac{2}{\pi D^2} A \sqrt{2 g} (0) + C\right)^2 \\
h0 &amp;= C^2 \\
C &amp;= \pm \sqrt{h0}
\end{align}\]</div>
<p>Thus the solution is</p>
<div class="amsmath math notranslate nohighlight" id="equation-37eddc95-d112-47b2-88b4-958490f97748">
<span class="eqno">(14)<a class="headerlink" href="#equation-37eddc95-d112-47b2-88b4-958490f97748" title="Permalink to this equation">#</a></span>\[\begin{align}
h(t) &amp;= \left(-\frac{2}{\pi D^2} A \sqrt{2 g} t + \sqrt{h0}\right)^2 \\
\end{align}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the solution is not dependent on the fluid density or viscosity. Does that make sense? Or in other words, would you expect a low viscosity fluid like water to drain faster or slower than a highly viscous fluid like honey? Logic says the honey would drain slower, but the solution says it would drain at the same rate. Why is that?</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Plot of the solution is:</span>
<span class="c1"># 1st import needed packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># 2nd define constants</span>
<span class="n">inch2meter</span> <span class="o">=</span> <span class="mf">0.0254</span> <span class="c1">#m</span>
<span class="n">gravity</span> <span class="o">=</span> <span class="mf">9.81</span> <span class="c1">#m/s^2</span>
<span class="n">orificeDiameter</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="o">*</span><span class="mf">0.0254</span> <span class="c1">#m</span>
<span class="n">Area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="n">orificeDiameter</span><span class="o">**</span><span class="mi">2</span> <span class="c1">#exit area of the water jet, m^2</span>
<span class="n">height0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="o">+</span><span class="mi">3</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="mf">0.0254</span> <span class="c1">#initial height of water in the tank, m</span>
<span class="n">Dia</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">9</span><span class="o">/</span><span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="mf">0.0254</span> <span class="c1">#diameter of the tank, m</span>
<span class="c1"># 3rd determine the emptying time</span>
<span class="n">emptiedTime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">height0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Dia</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Area</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">gravity</span><span class="p">))</span>
<span class="c1"># 4th define the function for the height of the water in the tank</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">emptiedTime</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Dia</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Area</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">gravity</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">height0</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">height</span><span class="p">(</span><span class="n">time</span><span class="p">)</span><span class="o">/</span><span class="n">inch2meter</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fluid height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height (in)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/985c4368f3a88ad179ff6e72a13230f3da8a02440f57a6a74159405243a25bc2.png" src="../_images/985c4368f3a88ad179ff6e72a13230f3da8a02440f57a6a74159405243a25bc2.png" />
</div>
</div>
</section>
<section id="numerical-solution-euler-s-method">
<h3>Numerical Solution: Euler’s Method<a class="headerlink" href="#numerical-solution-euler-s-method" title="Permalink to this heading">#</a></h3>
<p>The numerical solution will use a finite difference approximation to the derivative, the simplest of which is called Euler’s method. Euler’s method is based on the definition of the derivative:</p>
<p>$$\frac{df}{dt} = \lim_{\Delta t \rightarrow 0} \frac{f(t+\Delta t) - f(t)}{\Delta t}$$</p>
<p>From the above the problem definition, we can rewrite the differential equation as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5af57d32-5314-4cee-9951-f7d166ef8d1b">
<span class="eqno">(15)<a class="headerlink" href="#equation-5af57d32-5314-4cee-9951-f7d166ef8d1b" title="Permalink to this equation">#</a></span>\[\begin{align}
\frac{dh}{dt} = f(h) = -\frac{4}{\pi D^2} A \sqrt{2 g h} \\
\end{align}\]</div>
<p>Using Euler’s method:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5f289a5a-c039-42ea-83b3-20085b371516">
<span class="eqno">(16)<a class="headerlink" href="#equation-5f289a5a-c039-42ea-83b3-20085b371516" title="Permalink to this equation">#</a></span>\[\begin{align}
f(t+\Delta t) &amp;= f(t) + \frac{df}{dt} \Delta t \\
h(t+\Delta t) &amp;= h(t) + \frac{dh}{dt} \Delta t \\
h(t+\Delta t) &amp;= h(t) + f(h) \Delta t \\
h(t+\Delta t) &amp;= h(t) + -\frac{4}{\pi D^2} A \sqrt{2 g h(t)} \Delta t \\
\end{align}\]</div>
<p>Now we’ll use the above formulation to solve for the fluid height as a function of time. We’ll also compare that solution to the analytical solution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Euler&#39;s method/solution for the height of the fluid in the tank</span>
<span class="c1"># 1st import needed packages</span>
<span class="c1">## See above</span>
<span class="c1"># 2nd define constants</span>
<span class="c1">## Use the same constants as above</span>
<span class="c1"># 3rd define the function for the height of the water in the tank</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1">#time step</span>
<span class="n">timeE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">derivative</span><span class="p">(</span><span class="n">height</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">height</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Dia</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Area</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">gravity</span><span class="o">*</span><span class="n">height</span><span class="p">)</span>
<span class="n">heightEuler</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">timeE</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">heightEuler</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">height0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">heightEuler</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">heightEuler</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">derivative</span><span class="p">(</span><span class="n">heightEuler</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">timeE</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">timeE</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 5th plot the solution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">height</span><span class="p">(</span><span class="n">time</span><span class="p">),</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timeE</span><span class="p">,</span> <span class="n">heightEuler</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Euler method, dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fluid height&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Height (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6a6b959cdb9152dbf99f9f0512a3f43914809ca7f2be203595ad3697def9c2b2.png" src="../_images/6a6b959cdb9152dbf99f9f0512a3f43914809ca7f2be203595ad3697def9c2b2.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note: The Euler method will approach the analytical solution with smaller time steps. Try changing the time step to see how the solution changes.</p>
</div>
</section>
<section id="numerical-solution-ode-int-scipy">
<h3>Numerical Solution: ODE Int (SciPy)<a class="headerlink" href="#numerical-solution-ode-int-scipy" title="Permalink to this heading">#</a></h3>
<p>Euler’s method isn’t the best algorithm to use. There are better algorithms like 4th order Runge-Kutta. <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html">Scipy’s ODEINT</a> is used routinely for systems of differential equations. We’ll use the <code class="docutils literal notranslate"><span class="pre">odeint</span></code> function from the <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> module to solve the same above problem with one differential equation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1st import the needed packages</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="c1">## See above also</span>
<span class="c1"># 2nd define the derivative function (same as above but with time second)</span>
<span class="k">def</span> <span class="nf">derivativeODEINT</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">height</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Dia</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Area</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">gravity</span><span class="o">*</span><span class="n">height</span><span class="p">)</span>
<span class="c1"># 3rd define constants</span>
<span class="c1">## See above </span>
<span class="c1"># 4th Use ODEINT to solve the differential equation defined by the function derivative</span>
<span class="n">heightODEINT</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">derivativeODEINT</span><span class="p">,</span> <span class="n">height0</span><span class="p">,</span> <span class="n">timeE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 5th plot the solution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">height</span><span class="p">(</span><span class="n">time</span><span class="p">),</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timeE</span><span class="p">,</span> <span class="n">heightEuler</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Euler method, dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timeE</span><span class="p">,</span> <span class="n">heightODEINT</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ODEINT method, dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/bceca16985db5ca65c4b8f6c90bbd8aae21e9e7bbeefee88d26358fdc3e23c00.png" src="../_images/bceca16985db5ca65c4b8f6c90bbd8aae21e9e7bbeefee88d26358fdc3e23c00.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note: The ODEINT method is very close to analytical result even with a large delta t value. Try changing the time step to see how the solution changes.</p>
</div>
</section>
</section>
<section id="second-example-draining-of-tank-with-friction">
<h2>Second Example: Draining of Tank with Friction<a class="headerlink" href="#second-example-draining-of-tank-with-friction" title="Permalink to this heading">#</a></h2>
<p>Now we’ll look at the same problem, but with friction. The flow rate out of the tank is estimated by the following equation:</p>
<div class="amsmath math notranslate nohighlight" id="equation-0ce52483-8b1b-4a40-9bab-259fbebfa4df">
<span class="eqno">(17)<a class="headerlink" href="#equation-0ce52483-8b1b-4a40-9bab-259fbebfa4df" title="Permalink to this equation">#</a></span>\[\begin{align}
\dot{m} &amp;= \rho A v = \rho A \sqrt{2 g h} C_d \\
C_d &amp;= C_c C_v \\
\end{align}\]</div>
<p>where $\dot{m}$ is the mass flow rate, $\rho$ is the density, $A$ is the area of the hole, $g$ is the gravitational constant, $h$ is the height of the water above the hole, and $C_d$ is the discharge coefficient. $C_c$ is the coefficient of contraction and $C_v$ is the coefficient of velocity. The discharge coefficient is a dimensionless number that accounts for the frictional losses in the system. The discharge coefficient can vary depending on the geometry of the hole and the fluid viscosity.</p>
<p>A group from the UK and Nigeria measured nozzle discharge coefficients as published <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0894177718314304">here</a>. There, discharge coefficients are experimentally determined and compared to empirical equations like:</p>
<div class="amsmath math notranslate nohighlight" id="equation-45a4eb9e-7427-4c1a-a383-c92901ee38f9">
<span class="eqno">(18)<a class="headerlink" href="#equation-45a4eb9e-7427-4c1a-a383-c92901ee38f9" title="Permalink to this equation">#</a></span>\[\begin{align}
C_d &amp;= \frac{Re^{5/6}}{17.11\cdot l/d + 1.65\cdot Re^{0.8}} \\
Re &amp;= \frac{\rho D v}{\mu} \\
\end{align}\]</div>
<p>where $Re$ is the Reynolds number and $l/d$ is the length to diameter ratio of the nozzle. Solving for an analytical solution is not that easy but using the ODEINT function from the <code class="docutils literal notranslate"><span class="pre">scipy.integrate</span></code> module, we can solve the problem numerically.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the discharge coefficient function</span>
<span class="k">def</span> <span class="nf">dischargeCoefficient</span><span class="p">(</span><span class="n">Re</span><span class="p">,</span><span class="n">loverd</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Re</span><span class="o">**</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">17.11</span><span class="o">*</span><span class="n">loverd</span><span class="o">+</span><span class="mf">1.65</span><span class="o">*</span><span class="n">Re</span><span class="o">**</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We&#39;ll plot the above discharge coefficient as a function of the Reynolds number for a given</span>
<span class="c1"># l/d value.</span>
<span class="n">Rey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Rey</span><span class="p">,</span> <span class="n">dischargeCoefficient</span><span class="p">(</span><span class="n">Rey</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;l/d = 0.01&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Rey</span><span class="p">,</span> <span class="n">dischargeCoefficient</span><span class="p">(</span><span class="n">Rey</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;l/d = 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Reynolds number&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Discharge coefficient&#39;</span><span class="p">);</span><span class="n">plt</span><span class="o">.</span><span class="n">xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">);</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/36c3af12d48ff4e9b96c71bb09bd869aa92ffcfddcc53cf878ee31f6716f483d.png" src="../_images/36c3af12d48ff4e9b96c71bb09bd869aa92ffcfddcc53cf878ee31f6716f483d.png" />
</div>
</div>
<p>This is a complex problem as the velocity of the fluid depends on the discharge coefficient and the discharge coefficient depends on the fluid velocity. For each call to the derivative function, an fsolve is required to determine the exit velocity.</p>
<p>The equation to solve to determine the reynolds  number given the height of fluid in the tank is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5b4dd13f-eb6b-419b-b43a-e5791a5283ea">
<span class="eqno">(19)<a class="headerlink" href="#equation-5b4dd13f-eb6b-419b-b43a-e5791a5283ea" title="Permalink to this equation">#</a></span>\[\begin{align}
v = \frac{\dot{m}}{\rho A} = \sqrt{2 g h} C_d(Re) \\
Re = \frac{\rho D v}{\mu} = \frac{\rho D \sqrt{2 g h} C_d(Re)}{\mu} \\
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a function that should equal zero to determine the Reynolds number</span>
<span class="k">def</span> <span class="nf">ReZero</span><span class="p">(</span><span class="n">Re</span><span class="p">,</span><span class="n">loverd</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">mu</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Re</span> <span class="o">-</span> <span class="n">rho</span><span class="o">*</span><span class="n">D</span><span class="o">/</span><span class="n">mu</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="n">dischargeCoefficient</span><span class="p">(</span><span class="n">Re</span><span class="p">,</span> <span class="n">loverd</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Complete an example calculation with fsolve to find the Reynolds number given a height of fluid in the tank.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="c1">#use the args portion to pass the other variables to the function</span>
<span class="n">ReN</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">ReZero</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">9.81</span><span class="p">,</span> <span class="mi">1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1">#or you can use the lambda function (better as you can define the variables by name)</span>
<span class="n">ReNL</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">Re</span><span class="p">:</span> <span class="n">ReZero</span><span class="p">(</span><span class="n">Re</span><span class="p">,</span> <span class="n">loverd</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">9.81</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="mi">10000</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ReN</span><span class="p">,</span><span class="n">ReNL</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>38157.06745192405 38157.06745192405
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define fluid properties</span>
<span class="n">density</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1">#kg/m^3, water near 1000 kg/m^3 and honey near 1400 kg/m^3</span>
<span class="n">visc</span> <span class="o">=</span> <span class="mf">1e-3</span> <span class="c1">#Pa*s, water near 1e-3 Pa*s and honey near 10 Pa*s</span>
<span class="n">loverdh</span> <span class="o">=</span> <span class="n">orificeDiameter</span><span class="o">*</span><span class="mi">1</span> <span class="c1">#m, the l/d ratio near 1</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can solve for the height of the fluid in the tank as a function of time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the derivative function</span>
<span class="k">def</span> <span class="nf">derivativeODEINT2</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">height</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#first get the Reynolds number</span>
        <span class="n">Reyh</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="k">lambda</span> <span class="n">Re</span><span class="p">:</span> <span class="n">ReZero</span><span class="p">(</span><span class="n">Re</span><span class="p">,</span> <span class="n">loverd</span><span class="o">=</span><span class="n">loverdh</span><span class="p">,</span> <span class="n">rho</span><span class="o">=</span><span class="n">density</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">visc</span><span class="p">,</span> <span class="n">D</span><span class="o">=</span><span class="n">orificeDiameter</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="n">gravity</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">height</span><span class="p">),</span> <span class="mi">10000</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Cd</span> <span class="o">=</span> <span class="n">dischargeCoefficient</span><span class="p">(</span><span class="n">Reyh</span><span class="p">,</span> <span class="n">loverdh</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">Cd</span><span class="o">*</span><span class="mi">4</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Dia</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Area</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">gravity</span><span class="o">*</span><span class="n">height</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define constants of the tank</span>
<span class="c1">## See above </span>
<span class="c1"># 4th Use ODEINT to solve the differential equation defined by the function derivative</span>
<span class="n">heightODEINT2</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">derivativeODEINT2</span><span class="p">,</span> <span class="n">height0</span><span class="p">,</span> <span class="n">timeE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 5th plot the solutions</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">height</span><span class="p">(</span><span class="n">time</span><span class="p">),</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timeE</span><span class="p">,</span> <span class="n">heightEuler</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Euler method, dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timeE</span><span class="p">,</span> <span class="n">heightODEINT</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ODEINT method, dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timeE</span><span class="p">,</span> <span class="n">heightODEINT2</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ODEINT method with friction, dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a9eba1499619d65cd4044d2f08d6c4223afebc62cd49420dcce4958af22c8d2f.png" src="../_images/a9eba1499619d65cd4044d2f08d6c4223afebc62cd49420dcce4958af22c8d2f.png" />
</div>
</div>
<section id="video-of-the-above-scenario">
<h3>Video of the above scenario<a class="headerlink" href="#video-of-the-above-scenario" title="Permalink to this heading">#</a></h3>
<p>A video of the above scenario where water drains from graduated cylinder through a small hole. Height of the water in the cylinder as a function of time is approximated from the video.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>
<span class="k">def</span> <span class="nf">video</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;https://www.youtube.com/embed/&#39;</span><span class="o">+</span><span class="n">key</span><span class="o">+</span><span class="s1">&#39;&quot; </span><span class="se">\</span>
<span class="s1">             frameborder=&quot;0&quot; allow=&quot;autoplay; encrypted-media&quot; allowfullscreen&gt;&lt;/iframe&gt;&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/6d/1jr2w1qx1rnd2nkndlq4hc700000gn/T/ipykernel_15323/3944168696.py:1: DeprecationWarning: Importing display from IPython.core.display is deprecated since IPython 7.14, please import from IPython display
  from IPython.core.display import display, HTML
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">video</span><span class="p">(</span><span class="s1">&#39;CiDzF9dKrwc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/clintguymon/opt/anaconda3/envs/jupiterbook/lib/python3.9/site-packages/IPython/core/display.py:431: UserWarning: Consider using IPython.display.IFrame instead
  warnings.warn(&quot;Consider using IPython.display.IFrame instead&quot;)
</pre></div>
</div>
<div class="output text_html"><iframe width="560" height="315" src="https://www.youtube.com/embed/CiDzF9dKrwc"              frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#From the experiment, the height as a function of time is approximately </span>
<span class="n">exptime</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="mi">17</span><span class="o">/</span><span class="mi">29</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="mi">19</span><span class="o">/</span><span class="mi">29</span><span class="p">,</span> <span class="mi">4</span><span class="o">+</span><span class="mi">20</span><span class="o">/</span><span class="mi">29</span><span class="p">,</span> <span class="mi">10</span><span class="o">+</span><span class="mi">17</span><span class="o">/</span><span class="mi">29</span><span class="p">,</span> <span class="mi">14</span><span class="o">+</span><span class="mi">23</span><span class="o">/</span><span class="mi">29</span><span class="p">,</span> <span class="mi">18</span><span class="o">+</span><span class="mi">6</span><span class="o">/</span><span class="mi">29</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">34</span><span class="p">])</span>
<span class="n">expml</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">250</span><span class="p">,</span>  <span class="mi">240</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span>      <span class="mi">220</span><span class="p">,</span>      <span class="mi">200</span><span class="p">,</span>     <span class="mi">150</span><span class="p">,</span>    <span class="mi">120</span><span class="p">,</span>     <span class="mi">100</span><span class="p">,</span>     <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="n">expml</span> <span class="o">=</span> <span class="n">expml</span><span class="o">-</span><span class="mi">40</span> <span class="c1">#subtract the 40 ml of the height for the position of the orifice</span>
<span class="c1"># Now convert the ml value to a height with the given diameter</span>
<span class="n">expheight</span> <span class="o">=</span> <span class="n">expml</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">Dia</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="mf">1e6</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">height</span><span class="p">(</span><span class="n">time</span><span class="p">),</span><span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Analytical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timeE</span><span class="p">,</span> <span class="n">heightEuler</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Euler method, dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timeE</span><span class="p">,</span> <span class="n">heightODEINT</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ODEINT method, dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">timeE</span><span class="p">,</span> <span class="n">heightODEINT2</span><span class="p">,</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;ODEINT method with friction, dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exptime</span><span class="p">,</span> <span class="n">expheight</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Experimental&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2977cd46f9c6de4f080335639fbea2adca6457745760ec71ce6094891cbf7e56.png" src="../_images/2977cd46f9c6de4f080335639fbea2adca6457745760ec71ce6094891cbf7e56.png" />
</div>
</div>
<p>The agreement between the numerical solution including friction and the experimental values (roughly estimated from the video) is pretty good. What does that mean? What else can you conclude? How else could you use this information?</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./lectures"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="05-EquationsAgain.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">05-More Equation Solving</p>
      </div>
    </a>
    <a class="right-next"
       href="07-DerivativesAgain.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">07-More Derivatives</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#first-example-frictionless-emptying-a-tank-of-fliud">First Example: Frictionless emptying a tank of fliud</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analytical-solution">Analytical Solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-solution-euler-s-method">Numerical Solution: Euler’s Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-solution-ode-int-scipy">Numerical Solution: ODE Int (SciPy)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#second-example-draining-of-tank-with-friction">Second Example: Draining of Tank with Friction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#video-of-the-above-scenario">Video of the above scenario</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Clint Guymon, Brigham Young University
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>