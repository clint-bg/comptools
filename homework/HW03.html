

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>HW03: Solve Equations &#8212; Computational Tools for Chemical Engineers</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'homework/HW03';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="HW07: Additional Practice" href="HW07.html" />
    <link rel="prev" title="HW02: Conditionals and Functions" href="HW02.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Intro and Approach
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../topics.html">Modules</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/01-Motive.html">01-Motivation with Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/02-Functions.html">02-Functions of Ideal Gases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/03-FunctionsAgain.html">03-Functions of Heat Transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/04-Debug.html">04-Debug</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/05-Units.html">05-Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/06-Equations.html">06-Equations to Solve Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/07-EquationsAgain.html">07-More Equation Solving</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/08-Derivatives.html">08-Derivatives and Transients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/09-DerivativesAgain.html">09-More Derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/10-Loops.html">10-Loops: Brownian Motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/11-Regression.html">11-Regression and Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/12-RegressionAgain.html">12-More Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/13-ExamReview.html">13-Exam Review (Python)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/14-ExcelBasics.html">14-Excel Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/15-MoreExcel.html">15-More Excel Practice</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/16-ExcelFunctions.html">16-Excel Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/17-SolidWorks.html">17-SolidWorks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/18-AspenHysys.html">18-Aspen Hysys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/19-Ansys.html">19-Ansys Workbench</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/20-Cantera.html">20-Cantera</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/21-CaseStudy1.html">21-First Case Study Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/22-CaseStudy2.html">22-Second Case Study Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/23-FinalReview.html">23-Final Exam Review</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../homework.html">Practice Problems</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="HW01.html">HW01: Introduction to Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="HW02.html">HW02: Conditionals and Functions</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">HW03: Solve Equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="HW07.html">HW07: Additional Practice</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../casestudies.html">Case Studies</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../casestudies/casestudysch.html">Case Study Schedule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../casestudies/heattransfer.html">Heat Transfer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../casestudies/thermo.html">Thermodynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../casestudies/MD.html">Molecular Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../casestudies/casestudydocs.html">Case Study Documentation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../foundations.html">Foundations</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../foundations/preClassPrep.html">Pre-course Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../foundations/pythonresources.html">Python Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../foundations/excelresources.html">Excel Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../foundations/equipment.html">Equipment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../foundations/safety.html">Safety</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgement.html">Acknowledgement</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/clint-bg/comptools/blob/gh-pages/docs/homework/HW03.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/clint-bg/comptools" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/clint-bg/comptools/issues/new?title=Issue%20on%20page%20%2Fhomework/HW03.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/homework/HW03.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>HW03: Solve Equations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-1">Problem #1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-2">Problem #2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-3">Problem #3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-4">Problem #4</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="hw03-solve-equations">
<h1>HW03: Solve Equations<a class="headerlink" href="#hw03-solve-equations" title="Permalink to this heading">#</a></h1>
<p>Systems of equations are solved by finding variable values that satisfy all of the equations. With linear systems of equations, there is typically a unique solution that is easy to solve, even for large-scale systems. Nonlinear equations can be more challenging to solve and may have multiple solutions. Variable bounds and a good initial guess are sometimes required for nonlinear systems of equations. This section is to solve systems of:</p>
<ul class="simple">
<li><p>Linear systems of equations</p></li>
<li><p>Nonlinear systems of equations</p></li>
</ul>
<section id="problem-1">
<h2>Problem #1<a class="headerlink" href="#problem-1" title="Permalink to this heading">#</a></h2>
<p>Solve the following systems of linear algebraic equations <span class="math notranslate nohighlight">\(\left(A\,x = b\right)\)</span> using matrix calculations such as:</p>
<p><span class="math notranslate nohighlight">\(\left[ {\begin{array}{cc} 1 &amp; 2 \\ 1.5 &amp; -1 \\ \end{array} } \right] \left[ {\begin{array}{c} x_0 \\ x_1 \end{array} } \right] = \left[ {\begin{array}{c} 0 \\ 0.5 \end{array} } \right]\)</span></p>
<p>An array is defined with square brackets as a list or numpy array.</p>
<p><em><strong>Vector:</strong></em> A vector (1D array) is:</p>
<p><span class="math notranslate nohighlight">\(b = \left[ {\begin{array}{c} 0 \\ 0.5 \end{array} } \right]\)</span></p>
<p>and is defined as a list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>
</pre></div>
</div>
<p>or as a numpy array:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span>
</pre></div>
</div>
<p><em><strong>Matrix:</strong></em> A matrix (2D array) is:</p>
<p><span class="math notranslate nohighlight">\(A = \left[ {\begin{array}{cc} 1 &amp; 2 \\ 1.5 &amp; -1 \\ \end{array} } \right]\)</span></p>
<p>and is defined as a list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],[</span><span class="mf">1.5</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0</span><span class="p">]]</span>
</pre></div>
</div>
<p>or as a numpy array:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],[</span><span class="mf">1.5</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0</span><span class="p">]])</span>
</pre></div>
</div>
<p><em><strong>Solution Method #1:</strong></em> The solution to this set of equations can be found by inverting the matrix <span class="math notranslate nohighlight">\(A\)</span> and multiplying by <span class="math notranslate nohighlight">\(b\)</span> as <span class="math notranslate nohighlight">\(x=A^{-1}\,b\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\left[ {\begin{array}{c} x_0 \\ x_1 \end{array} } \right] = \left[ {\begin{array}{cc} 1 &amp; 2 \\ 1.5 &amp; -1 \\ \end{array} } \right]^{-1} \left[ {\begin{array}{c} 0 \\ 0.5 \end{array} } \right]\)</span></p>
<p>The inverse of a matrix can be found with the function <code class="docutils literal notranslate"><span class="pre">np.linalg.inv</span></code>. Two matrices are multiplied together with the dot product with function <code class="docutils literal notranslate"><span class="pre">np.dot</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># practice problem</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],[</span><span class="mf">1.5</span><span class="p">,</span><span class="o">-</span><span class="mf">1.0</span><span class="p">]]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]</span>
<span class="n">invA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">invA</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.25  -0.125]
</pre></div>
</div>
</div>
</div>
<p><em><strong>Solution Method #2:</strong></em> The function <code class="docutils literal notranslate"><span class="pre">np.linalg.solve</span></code> can also be used to find <code class="docutils literal notranslate"><span class="pre">x</span></code> for linear systems of equations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.25  -0.125]
</pre></div>
</div>
</div>
</div>
<p><em><strong>Parse Solution:</strong></em> Individual values can be accessed by referencing the specific location in the array. An array index starts with 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.25
</pre></div>
</div>
</div>
</div>
<p><em><strong>Last Value in Array:</strong></em> The last value of this array can be accessed with <code class="docutils literal notranslate"><span class="pre">x[1]</span></code> or with <code class="docutils literal notranslate"><span class="pre">x[-1]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-0.125
-0.125
</pre></div>
</div>
</div>
</div>
<p><em><strong>Array References:</strong></em> The second to last value of any array can be accessed with <code class="docutils literal notranslate"><span class="pre">x[-2]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.25
</pre></div>
</div>
</div>
</div>
<p><em><strong>Action:</strong></em> Find the values of <code class="docutils literal notranslate"><span class="pre">x</span></code> that satisfy the following system of linear equations (<span class="math notranslate nohighlight">\(A \, x = b\)</span>):</p>
<p><span class="math notranslate nohighlight">\(\left[ {\begin{array}{ccccc} 11 &amp; 7 &amp; 0 &amp; 1 &amp; 2 \\ 0 &amp; 5 &amp; 2 &amp; 0 &amp; 1 \\ 3 &amp; 2 &amp; 7 &amp; 1 &amp; 0 \\ 4 &amp; 0 &amp; 4 &amp; 10 &amp; 1 \\ 2 &amp; 5&amp; 1 &amp; 3 &amp; 14 \end{array} } \right] \left[ {\begin{array}{c} x_0 \\ x_1 \\ x_2 \\ x_3 \\ x_4 \end{array} } \right] = \left[ {\begin{array}{c} 45 \\ 30 \\ 15 \\ 20 \\ 92 \end{array} } \right]\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">11.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">2.0</span><span class="p">],</span>\
     <span class="p">[</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">],</span>\
     <span class="p">[</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">0.0</span><span class="p">],</span>\
     <span class="p">[</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span>  <span class="mf">1.0</span><span class="p">],</span>\
     <span class="p">[</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>  <span class="mf">3.0</span><span class="p">,</span> <span class="mf">14.0</span><span class="p">]]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mf">45.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">92.0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><em><strong>Action:</strong></em> Solve the equations with a different method and compare the solution to the one above.</p>
<p><em><strong>Action:</strong></em> Print the last value of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</section>
<section id="problem-2">
<h2>Problem #2<a class="headerlink" href="#problem-2" title="Permalink to this heading">#</a></h2>
<p>A nonlinear equation solver such as <code class="docutils literal notranslate"><span class="pre">scipy.optimize.fsolve</span></code> can also solve linear equations. Returning to the introductory example:</p>
<p><span class="math notranslate nohighlight">\(\left[ {\begin{array}{cc} 1 &amp; 2 \\ 1.5 &amp; -1 \\ \end{array} } \right] \left[ {\begin{array}{c} x_0 \\ x_1 \end{array} } \right] = \left[ {\begin{array}{c} 0 \\ 0.5 \end{array} } \right]\)</span></p>
<p>This is solved with <code class="docutils literal notranslate"><span class="pre">fsolve</span></code> by placing all of the equations to one side as:</p>
<p><span class="math notranslate nohighlight">\(\left[ {\begin{array}{cc} 1 &amp; 2 \\ 1.5 &amp; -1 \\ \end{array} } \right] \left[ {\begin{array}{c} x_0 \\ x_1 \end{array} } \right] - \left[ {\begin{array}{c} 0 \\ 0.5 \end{array} } \right] = \left[ {\begin{array}{c} f_0 \\ f_1 \end{array} } \right]\)</span></p>
<p>The equation is solved when <span class="math notranslate nohighlight">\(f_0\)</span> and <span class="math notranslate nohighlight">\(f_1\)</span> are equal to zero. The <code class="docutils literal notranslate"><span class="pre">fsolve</span></code> function requires a function that returns the residuals (<span class="math notranslate nohighlight">\(f_1\)</span> and <span class="math notranslate nohighlight">\(f_2\)</span>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">f2</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>The function solver <code class="docutils literal notranslate"><span class="pre">fsolve</span></code> also  an initial guess. A few guess values are evaluated below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># guess solutions</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.0, -0.5]
[1.5, -0.25]
[1.0, 1.0]
</pre></div>
</div>
</div>
</div>
<p>Guess values for <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(x_1\)</span> are selected as <code class="docutils literal notranslate"><span class="pre">[1,1]</span></code> and <code class="docutils literal notranslate"><span class="pre">fsolve</span></code> finds the solution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">f</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.25  -0.125]
</pre></div>
</div>
</div>
</div>
<p><em><strong>Action:</strong></em> Determine one solution for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> to the following equations (there are 4 possible solutions).</p>
<p><span class="math notranslate nohighlight">\(2 x^2 + y^2 = 1\)</span></p>
<p><span class="math notranslate nohighlight">\((0.5x-0.5)^2+2(y-0.25)^2=1\)</span></p>
<p>The initial guess can be adjusted to find a different solution.</p>
</section>
<section id="problem-3">
<h2>Problem #3<a class="headerlink" href="#problem-3" title="Permalink to this heading">#</a></h2>
<p>The Redlich/Kwong Equation of State is</p>
<p><span class="math notranslate nohighlight">\(P = \frac{R_g \, T}{V-b} - \frac{a}{T^{1/2} \, V \, \left(V+b\right)}\)</span></p>
<p>where <span class="math notranslate nohighlight">\(T\)</span> is the temperature, <span class="math notranslate nohighlight">\(V\)</span> is the molar volume, <span class="math notranslate nohighlight">\(R_g\)</span> is the universal gas constant, and <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are compound-specific constants.  Find the molar volume of ethane for each phase that is present at <span class="math notranslate nohighlight">\(T = 77 \, °C\)</span> and <span class="math notranslate nohighlight">\(P = 1 \, bar\)</span>.  For ethane, <span class="math notranslate nohighlight">\(a = 2.877×10^8 \, \frac{cm^6 bar K^{0.5}}{mol^2}\)</span> and <span class="math notranslate nohighlight">\(b = 60.211 \, \frac{cm^3}{mol}\)</span>.</p>
<ul class="simple">
<li><p>Use the ideal gas law to obtain the guess of the vapor volume and 1.1*b to obtain the guess for the liquid volume.  (Graphing helps find good guesses for solver)</p></li>
<li><p>You may need to include some constraints.</p></li>
<li><p>IF YOU ARE STUCK ask a friend, the TA OR the instructor!  Don’t spent so much time feeling lost that you become discouraged.</p></li>
<li><p>You should obtain something around 28637 <span class="math notranslate nohighlight">\(cm^3/mol\)</span> for the vapor volume and 82.477 <span class="math notranslate nohighlight">\(cm^3/mol\)</span> for the liquid volume.  The middle root (not required but for your information) is in between.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">fsolve</span>

<span class="c1"># constants</span>
<span class="n">TC</span> <span class="o">=</span> <span class="mi">77</span> <span class="c1"># degC</span>
<span class="n">P</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># bar</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">2.877e8</span> <span class="c1"># cm^6 bar K^0.5 / mol^2</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">60.211</span>  <span class="c1"># cm^3 / mol</span>
<span class="n">Rg</span> <span class="o">=</span> <span class="mf">83.144598</span> <span class="c1"># cm^3 bar / K-mol</span>
<span class="c1"># derived quantities</span>
<span class="n">TK</span> <span class="o">=</span> <span class="n">TC</span><span class="o">+</span><span class="mf">273.15</span> <span class="c1"># K</span>

<span class="c1"># define function for fsolve</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">V</span><span class="p">):</span>
    <span class="k">return</span> <span class="c1"># fill-in</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="problem-4">
<h2>Problem #4<a class="headerlink" href="#problem-4" title="Permalink to this heading">#</a></h2>
<p>Imagine mixing liquid benzene (species 1) and toluene (species 2) together in an initially empty container. At equilibrium, some of the liquid from both species evaporates into the vapor phase and some is left liquid phase for certain temperatures and pressures. In thermodynamics, you learn that Raoult’s law may be used to describe the distribution of species in each phase. For the specific example mentioned above, Raoult’s law gives the following two expressions describing the equilibrium state</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
y_1 P = x_1 P_1^{sat}(T) \\
y_2 P = x_2 P_2^{sat}(T)
\end{align}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(y_i\)</span> is the mole fraction of species <span class="math notranslate nohighlight">\(i\)</span> (either 1 or 2) in the vapor phase, <span class="math notranslate nohighlight">\(x_i\)</span> is the mole fraction of species <span class="math notranslate nohighlight">\(i\)</span> in the liquid phase, <span class="math notranslate nohighlight">\(P_i^{sat}(T)\)</span> is the vapor pressure of species <span class="math notranslate nohighlight">\(i\)</span> at the system temperature <span class="math notranslate nohighlight">\(T\)</span>, and <span class="math notranslate nohighlight">\(P\)</span> is the system pressure.</p>
<p>The vapor pressures of benzene and toluene can be found using the Antione Equation given below:</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\ln{\left(P_i^{sat}(T) \right)} = A_i - \frac{B_i}{T+ C_i}
\end{equation}
\]</div>
<p>Note that <span class="math notranslate nohighlight">\(P_i^{sat}(T)\)</span> is not <span class="math notranslate nohighlight">\(P_i^{sat}\)</span> times <span class="math notranslate nohighlight">\(T\)</span>, but is simply showing that <span class="math notranslate nohighlight">\(P_i^{sat}\)</span> is a function of <span class="math notranslate nohighlight">\(T\)</span> in kPa.  The constants, <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, and <span class="math notranslate nohighlight">\(C\)</span>, are compound specific and are found in the table below. <span class="math notranslate nohighlight">\(T\)</span> is in <span class="math notranslate nohighlight">\(°C\)</span>.</p>
<p><em><strong>Antoine Constants for Benzene and Toluene:</strong></em></p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Compound</p></th>
<th class="head"><p>A</p></th>
<th class="head"><p>B</p></th>
<th class="head"><p>C</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Benzene</p></td>
<td><p>13.7819</p></td>
<td><p>2726.81</p></td>
<td><p>217.572</p></td>
</tr>
<tr class="row-odd"><td><p>Toluene</p></td>
<td><p>13.9320</p></td>
<td><p>3056.96</p></td>
<td><p>217.625</p></td>
</tr>
</tbody>
</table>
<p>If a mixture of benzene (species 1) and toluene (species 2) has <span class="math notranslate nohighlight">\(y_1 = 0.33\)</span> and <span class="math notranslate nohighlight">\(P = 120 \, kPa\)</span>, find <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(T\)</span>. Remember that the mole fractions of each phase must sum to 1.</p>
<ul class="simple">
<li><p>First figure out what you are solving for.  Then figure out how many equations you have.</p></li>
<li><p>You might want to set up a function for <span class="math notranslate nohighlight">\(P_1^{sat}\)</span> and <span class="math notranslate nohighlight">\(P_2^{sat}\)</span> that are a function of <span class="math notranslate nohighlight">\(T\)</span>.</p></li>
<li><p>You should get about 0.17 for <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(109 °C\)</span> for <span class="math notranslate nohighlight">\(T\)</span>.</p></li>
</ul>
<p>Credit to Dr. John Hedengren for these problems.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./homework"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="HW02.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">HW02: Conditionals and Functions</p>
      </div>
    </a>
    <a class="right-next"
       href="HW07.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">HW07: Additional Practice</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-1">Problem #1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-2">Problem #2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-3">Problem #3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-4">Problem #4</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Clint Guymon, Brigham Young University
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>